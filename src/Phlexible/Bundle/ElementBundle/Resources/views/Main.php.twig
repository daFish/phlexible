<?php

namespace {{ class.namespace }};

use Phlexible\Bundle\ElementBundle\Proxy\ChildStructureInterface;
use Phlexible\Bundle\ElementBundle\Proxy\MainStructureInterface;
use Phlexible\Bundle\ElementBundle\Proxy\StructureCollection;
{% include 'collection_import.php.twig' %}

{% for collection in class.collections %}
{% include 'collection_class.php.twig' %}
{% endfor %}

/**
 * DO NOT EDIT THIS FILE - IT WAS CREATED BY PHLEXIBLE'S PROXY GENERATOR
 *
 * @see \Phlexible\Bundle\ElementBundle\Proxy\Generator\ProxyGenerator
 */
final class {{ class.classname }} implements MainStructureInterface
{
    /**
     * @var string
     */
    private $__id;

    /**
     * @var int
     */
    private $__version;

{% include 'value_attributes.php.twig' %}
{% include 'structure_attributes.php.twig' %}
{% include 'collection_attributes.php.twig' %}

    public function __construct($id, $version)
    {
        $this->id = $id;
        $this->version = $version;
{% include 'collection_init.php.twig' %}
    }

{% include 'value_values.php.twig' %}

    /**
     * @param array $children
     */
    public function __setChildren(array $children)
    {
        foreach ($children as $collectionName => $collection) {
            foreach ($collection as $structure) {
{% include 'collection_set_children.php.twig' %}
{% include 'structure_set_children.php.twig' %}
            }
        }
    }

    /**
     * @return array
     */
    public function __getChildren()
    {
        return array(
{% include 'collection_get_children.php.twig' %}
{% include 'structure_get_children.php.twig' %}
        );
    }

    /**
     * @return string
     */
    public function __id()
    {
        return $this->id;
    }

    /**
     * @return int
     */
    public function __version()
    {
        return $this->version;
    }

    /**
     * @return string
     */
    public function __elementtypeId()
    {
        return '{{ class.elementtypeId }}';
    }

    /**
     * @return int
     */
    public function __elementtypeRevision()
    {
        return {{ class.elementtypeRevision }};
    }

    /**
     * @return string
     */
    public function __elementtypeName()
    {
        return '{{ class.elementtypeName }}';
    }

    /**
     * @return ChildStructureInterface[]
     */
    public function __toArray()
    {
        $children = array();
        foreach ($this->__getChildren() as $name => $nameChildren) {
            foreach ($nameChildren as $child) {
                $childData = $child->__toArray();
                $childData['parent'] = $name;
                $children[] = $childData;
            }
        }
        return array(
            'id'       => $this->__id(),
            'version'  => $this->__version(),
            'values'   => $this->__getValues(),
            'children' => $children
        );
    }
}
